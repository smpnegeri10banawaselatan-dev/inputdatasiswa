<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Database Siswa</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">

  <div class="max-w-5xl mx-auto">
    <h1 class="text-2xl font-bold text-center text-blue-700 mb-6">Database Siswa</h1>

    <!-- Form Input -->
    <div class="bg-white p-4 rounded-lg shadow mb-6">
      <h2 class="text-lg font-semibold mb-4">Tambah Siswa Baru</h2>
      <form id="formSiswa" class="grid md:grid-cols-2 gap-4">
        <input class="border p-2 rounded" type="text" name="nama" placeholder="Nama Siswa" required />
        <input class="border p-2 rounded" type="text" name="kelas" placeholder="Kelas" required />
        <select name="jk" class="border p-2 rounded" required>
          <option value="">Pilih Jenis Kelamin</option>
          <option value="Laki-laki">Laki-laki</option>
          <option value="Perempuan">Perempuan</option>
        </select>
        <input class="border p-2 rounded" type="text" name="nisn" placeholder="NISN" />
        <input class="border p-2 rounded col-span-2" type="text" name="alamat" placeholder="Alamat" />
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded col-span-2">Simpan</button>
      </form>
      <p id="status" class="text-green-600 mt-2"></p>
    </div>

    <!-- Tabel Data -->
    <div class="bg-white p-4 rounded-lg shadow overflow-auto">
      <h2 class="text-lg font-semibold mb-4">Daftar Siswa</h2>
      <table id="tabelSiswa" class="min-w-full text-sm text-left">
        <thead class="bg-blue-700 text-white">
          <tr></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

<script>
const sheetID = '1nAi5myvlMVVz1907FXB870iOyfZJGj38Prt49PU_xoU';
const sheetName = 'NamaSiswa';
const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?sheet=${sheetName}`;
const scriptURL = 'PASTE_APPS_SCRIPT_URL_HERE'; // Ganti dengan URL Web Apps kamu

// Load data dari Spreadsheet
fetch(url)
  .then(res => res.text())
  .then(rep => {
    const data = JSON.parse(rep.substr(47).slice(0, -2));
    const theadRow = document.querySelector('#tabelSiswa thead tr');
    const tbody = document.querySelector('#tabelSiswa tbody');

    // Buat header
    data.table.cols.forEach(col => {
      const th = document.createElement('th');
      th.className = "p-2 border";
      th.textContent = col.label;
      theadRow.appendChild(th);
    });

    // Buat isi
    data.table.rows.forEach(row => {
      const tr = document.createElement('tr');
      row.c.forEach(cell => {
        const td = document.createElement('td');
        td.className = "p-2 border";
        td.textContent = cell ? cell.v : '';
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  });

// Submit Form
document.getElementById('formSiswa').addEventListener('submit', function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const data = Object.fromEntries(formData.entries());

  fetch(scriptURL, {
    method: 'POST',
    body: JSON.stringify(data),
    headers: { 'Content-Type': 'application/json' }
  })
  .then(res => res.text())
  .then(msg => {
    document.getElementById('status').textContent = "Data berhasil ditambahkan!";
    this.reset();
  })
  .catch(err => {
    document.getElementById('status').textContent = "Gagal menambahkan data.";
    console.error(err);
  });
});
</script>
</body>
</html>
